%%
%% This is file `uebbgrammar.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% uebbgrammar.dtx  (with options: `package')
%% 
%% This is a generated file.
%% 
%% Copyright (c) 2009, 2010, Florian Lorenzen
%% 
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either
%% version 1.3 of this license or (at your option) any later
%% version. The latest version of this license is in:
%% 
%%   http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3 or later is part of all distributions of
%% LaTeX version 2003/12/01 or later.
%% 
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{uebbgrammar}
  [2011/04/12 v0.6 LaTeX macros for context-free grammars]
\RequirePackage{ifthen}[2001/05/26]
\RequirePackage{amsmath}[2000/07/18]
\RequirePackage{float}[2000/11/08]
\RequirePackage{keyval}[1999/03/16]

\DeclareOption{chapter}{\renewcommand{\@grammarnumberingwithin}{chapter}}%
\DeclareOption{section}{\renewcommand{\@grammarnumberingwithin}{section}}%
\DeclareOption{subsection}{\renewcommand{\@grammarnumberingwithin}{subsection}}%
\def\@grammarnumberingwithin{}
\ProcessOptions
\def\@grammarsep{::=}
\def\@grammarrep{\,{}^\otimes\,}
\def\@grammarrepi{\,{}^\oplus\,}
\def\@terminalstyledecl{\tt}
\def\@terminalstylebox{}
\def\@nonterminalstyledecl{\it}
\def\@commentsign{---}
\def\@commentstyle{\normalfont}
\def\@grammarcaptionprefix{Grammar}
\define@key{@gramkeyval}{sep}
{\renewcommand{\@grammarsep}{#1}}

\define@key{@gramkeyval}{terminalstyledecl}
{\renewcommand{\@terminalstyledecl}{#1}}

\define@key{@gramkeyval}{terminalstylebox}
{\renewcommand{\@terminalstylebox}{#1}}

\define@key{@gramkeyval}{nonterminalstyledecl}
{\renewcommand{\@nonterminalstyledecl}{#1}}

\define@key{@gramkeyval}{commentsign}
{\renewcommand{\@commentsign}{#1}}

\define@key{@gramkeyval}{commentstyle}
{\renewcommand{\@commentstyle}{#1}}

\define@key{@gramkeyval}{rep}
{\renewcommand{\@grammarrep}{#1}}

\define@key{@gramkeyval}{repi}
{\renewcommand{\@grammarrepi}{#1}}

\define@key{@gramkeyval}{grammarcaptionprefix}
{\renewcommand{\@grammarcaptionprefix}{#1}}
\newcommand{\setgrammarstyle}[1]{%
  \setkeys{@gramkeyval}{#1}%
}%
\ifthenelse{\equal{\@grammarnumberingwithin}{}}{%
  \newfloat{@grammarfigure}{tbph}{grm}%
}{%
  \newfloat{@grammarfigure}{tbph}{grm}[\@grammarnumberingwithin]%
}%\ifthenelse
\floatname{@grammarfigure}{\@grammarcaptionprefix}%
\newcommand{\listofgrammars}{%
  \listof{@grammarfigure}{List of Grammars}%
}
\newcommand{\grammarref}[1]{Grammar~\ref{#1}}
\newboolean{@terminal}
\setboolean{@terminal}{false}
\def\@sqopen{\left[}
\def\@sqclose{\right]}
\def\@kleenestar{*}
\def\@kleeneplus{+}
\def\@parenopen{\left(}
\def\@parenclose{\right)}
\newsavebox{\@terminalbox}
\def\@startterminal{\begin{lrbox}{\@terminalbox}}
\def\@stopterminal#1{\end{lrbox}#1{\usebox{\@terminalbox}}}
{%
  \catcode`\:\active%
  \catcode`<=\active%
  \catcode`>=\active%
  \catcode`|=\active%
  \catcode`\'=\active%
  \catcode`\^^M=\active%
  \catcode`[=\active%
  \catcode`]=\active%
  \catcode`(=\active%
  \catcode`)=\active%
  \catcode`*=\active%
  \catcode`+=\active%
  \catcode`~=\active%
  \catcode`!=\active%
  \gdef\@grammarsymbols{%
    \catcode`:=\active
    \catcode`<=\active%
    \catcode`>=\active%
    \catcode`|=\active%
    \catcode`\'=\active%
    \catcode`\^^M=\active%
    \catcode`[=\active%
    \catcode`]=\active%
    \catcode`(=\active%
    \catcode`)=\active%
    \catcode`*=\active%
    \catcode`+=\active%
    \catcode`~=\active%
    \catcode`!=\active%

    \def<{\@nonterminalstyledecl\bgroup}%
    \def>{\egroup\ }%
    \def'{\ifthenelse{\boolean{@terminal}}%
      {\egroup\end{math}\@stopterminal{\@terminalstylebox}\ \setboolean{@terminal}{false}}%
      {\setboolean{@terminal}{true}\@startterminal\begin{math}\@terminalstyledecl\bgroup}}%
    \def::={&\@grammarsep&}%
    \def\alt{&\mid&}%
    \def|{\mid\ }%
    \def[{\@sqopen}%
    \def]{\!\!\@sqclose\ }%
    \def({\@parenopen}%
    \def){\!\!\@parenclose\ }%
    \def*{\!\!\raisebox{0.75pt}{\@kleenestar}\;}%
    \def+{\!\!\raisebox{2pt}{\@kleeneplus}\;}%
    \def^^M{\\}%
    \def~{\!\!\!\@grammarrep\!}%
    \def!{\!\!\!\@grammarrepi\!}%
    \def\comment##1{& \text{\@commentsign\; \@commentstyle##1}}%
  }
}
\newcommand{\maketerminal}[2]{%
  \newcommand{#1}{\@terminalstylebox{\mbox{\@terminalstyledecl#2}}\ }%
}
\newcommand{\makenonterminal}[2]{%
  \newcommand{#1}{\mbox{\@nonterminalstyledecl#2}\ }%
}
\newcommand{\@grammarworkaround}{%
  \def\plus{+}%
  \def\plusT{\@terminalstylebox{\mbox{\@terminalstyledecl+}}}%
  \def\plusN{\mbox{\@nonterminalstyledecl+}}%
  \def\star{*}%
  \def\starT{\@terminalstylebox{\mbox{\@terminalstyledecl*}}}%
  \def\starN{\mbox{\@nonterminalstyledecl*}}%
  \def\excl{!}%
  \def\exclT{\@terminalstylebox{\mbox{\@terminalstyledecl!}}}%
  \def\exclN{\mbox{\@nonterminalstyledecl!}}%
  \def\snake{\tilde{}}%
  \def\snakeT{\@terminalstylebox{\mbox{\@terminalstyledecl\textasciitilde}}}%
  \def\snakeN{\mbox{\@nonterminalstyledecl\textasciitilde}}%
  \def\colon{:}%
  \def\colonT{\@terminalstylebox{\mbox{\@terminalstyledecl:}}}%
  \def\colonN{\mbox{\@nonterminalstyledecl:}}%
  \def\eq{=}%
  \def\eqT{\@terminalstylebox{\mbox{\@terminalstyledecl=}}}%
  \def\eqN{\mbox{\@nonterminalstyledecl=}}%
  \def\lt{<}%
  \def\ltT{\@terminalstylebox{\mbox{\@terminalstyledecl\textless}}}%
  \def\ltN{\mbox{\@nonterminalstyledecl\textless}}%
  \def\gt{>}%
  \def\gtT{\@terminalstylebox{\mbox{\@terminalstyledecl\textgreater}}}%
  \def\gtN{\mbox{\@nonterminalstyledecl\textgreater}}%
  \def\quot{\mbox{\@nonterminalstyledecl'}}%
  \def\quotT{\@terminalstylebox{\mbox{\@terminalstyledecl'}}}%
  \def\quotN{\mbox{\@nonterminalstyledecl'}}%
  \def\bar{\mid}%
  \def\barT{\@terminalstylebox{\mbox{\@terminalstyledecl\textbar}}}%
  \def\barN{\mbox{\@nonterminalstyledecl\textbar}}%
  \def\brop{[}%
  \def\bropT{\@terminalstylebox{\mbox{\@terminalstyledecl[}}}%
  \def\bropN{\mbox{\@nonterminalstyledecl[}}%
  \def\brcl{]}%
  \def\brclT{\@terminalstylebox{\mbox{\@terminalstyledecl]}}}%
  \def\brclN{\mbox{\@nonterminalstyledecl]}}%
  \def\pop{(}%
  \def\popT{\@terminalstylebox{\mbox{\@terminalstyledecl(}}}%
  \def\popN{\mbox{\@nonterminalstyledecl(}}%
  \def\pcl{)}%
  \def\pclT{\@terminalstylebox{\mbox{\@terminalstyledecl)}}}%
  \def\pclN{\mbox{\@nonterminalstyledecl)}}%
}
\newsavebox{\@grammarbox}
\newcommand{\@grammarstart}{%
  \begin{lrbox}{\@grammarbox}%
    \@grammarworkaround%
    \@grammarsymbols
    \begin{math}
      \begin{array}{lcll}
}
\newcommand{\@grammarend}{%
      \end{array}
    \end{math}
  \end{lrbox}
}
\newcommand{\@grammaroutput}{%
  \usebox{\@grammarbox}%
}
\newcommand{\@begingrammararray}{%
  \begin{array}{lcll}%
}
\newcommand{\@endgrammararray}{%
  \end{array}%
}
\newenvironment{grammar}{%
  \@grammarstart%
}{%
  \@grammarend%
  \@grammaroutput%
}
\newenvironment{displaygrammar}{%
  \@grammarstart%
}{%
  \@grammarend%
  \begin{center}%
    \@grammaroutput%
  \end{center}%
}
\newcommand{\@grammarcaption}{}
\newcommand{\@grammarlabel}{}

\newenvironment{grammarfigure}[2][NOLABEL]{%
  \renewcommand{\@grammarcaption}{#2}%
  \ifthenelse{\equal{#1}{NOLABEL}}{%
    \renewcommand{\@grammarlabel}{}%
  }{%
    \renewcommand{\@grammarlabel}{\label{#1}}%
  }%
  \@grammarstart%
}{%
  \@grammarend%
  \begin{@grammarfigure}%
    \caption{\@grammarcaption \@grammarlabel}%
    \begin{center}%
      \@grammaroutput%
    \end{center}%
    \vspace{-0.5\baselineskip}%
  \end{@grammarfigure}%
}
\endinput
%%
%% End of file `uebbgrammar.sty'.
